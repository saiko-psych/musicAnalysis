% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/klawa.R
\name{klawa_scan}
\alias{klawa_scan}
\title{KLAWA: scan a folder hierarchy and extract values}
\usage{
klawa_scan(
  root = "data/KLAWA",
  metadata_source = c("path", "pdf"),
  groups = NULL,
  measurements = NULL,
  pcs = NULL,
  code_pattern = "(\\\\d{4}[A-Za-zÄÖÜäöüß]{4})",
  date_format = "DDMMYY",
  auto_detect = TRUE
)
}
\arguments{
\item{root}{Path to the KLAWA root folder (default: "data/KLAWA").}

\item{metadata_source}{Character: "path" (default), "pdf", or "both". See Details.}

\item{groups}{Character vector of group names to recognize, or NULL for auto-detection.}

\item{measurements}{Character vector of measurement types to recognize, or NULL for auto-detection.}

\item{pcs}{Character vector of PC identifiers to recognize, or NULL for auto-detection.}

\item{code_pattern}{Regex pattern for participant codes. Default: "(\\\\d{4}[A-Za-z\\u00C4\\u00D6\\u00DC\\u00E4\\u00F6\\u00FC\\u00DF]{4})" (includes German umlauts).}

\item{date_format}{Character: date format in filenames. Options: "DDMMYY" (default), "DDMMYYYY", "YYMMDD", "YYYYMMDD", "MMDDYY", "MMDDYYYY".}

\item{auto_detect}{If TRUE (default) and groups/measurements/pcs are NULL, automatically detect from folder structure.}
}
\value{
A tibble with columns:
\itemize{
\item \code{group}, \code{measurement}, \code{pc}, \code{code}, \code{date} - Metadata from folder structure/filename
\item \code{code_pdf} - Participant code extracted from PDF content
\item \code{code_mismatch} - Logical flag: TRUE if filename code differs from PDF code
\item \code{volume_difference}, \code{pitch}, \code{onset_difference},
\code{pitch_duration_difference} - Numeric values from PDF
\item \code{file} - Path relative to \code{root}
}
}
\description{
Recursively searches \code{root} for KLAWA PDFs and returns a tidy tibble.
Metadata can be extracted from path/filename, PDF content, or both (with mismatch detection).
}
\details{
Label regexes are taken from \code{\link{ma_options}} (session-configurable).
If your PDFs use different terms, override just the needed label(s) before
scanning, e.g.:
\preformatted{
  set_ma_options(labels = list(
    pitch = "(Tonhoehe|Pitch|F0|Fo|Grundfrequenz)"
  ))
  df <- klawa_scan("data/KLAWA")
}

\strong{Metadata Sources:}
\itemize{
\item \code{"path"}: Extract from folder structure and filename (default, recommended)
\itemize{
\item Detects PC, group, and measurement from folder hierarchy
\item Extracts participant codes from filenames
}
\item \code{"pdf"}: Extract codes from PDF content only (for unorganized folders)
\itemize{
\item Note: PDFs typically only contain participant codes, not folder metadata
\item Group/measurement/PC information cannot be reliably extracted from PDFs
}
}
}
\examples{
\dontrun{
# Standard usage (metadata from path)
df <- klawa_scan("data/KLAWA")

# PDFs in flat folder (extract codes only, no folder metadata)
df <- klawa_scan("data/PDFs", metadata_source = "pdf")
}
}
