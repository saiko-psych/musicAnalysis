% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/aat.R
\name{aat_scan}
\alias{aat_scan}
\title{Scan AAT (Auditory Ambiguity Test) CSV files}
\usage{
aat_scan(
  root,
  code_pattern = "(\\\\d{4}[A-Za-z]{4})",
  date_format = "DDMMYY",
  ambiguous_items = NULL,
  control_items = NULL
)
}
\arguments{
\item{root}{Directory containing AAT files (will scan recursively).}

\item{code_pattern}{Regex pattern for extracting participant codes from filenames.
Default: \code{"(\\\\d{4}[A-Za-z]{4})"} (4 digits + 4 letters).}

\item{date_format}{Date format in filenames. One of: "DDMMYY", "DDMMYYYY", "YYMMDD",
"YYYYMMDD", "MMDDYY", "MMDDYYYY". Default: "DDMMYY".}

\item{ambiguous_items}{Optional numeric vector of item indices that are ambiguous (for .itl files).
If NULL, will attempt to detect from data or assume all non-control items.}

\item{control_items}{Optional numeric vector of item indices that are control items (for .itl files).
If NULL, will attempt to detect from data.}
}
\value{
A tibble with columns:
\itemize{
\item \code{code}: Participant code (from filename)
\item \code{date}: Date from filename (formatted as DD/MM/YYYY)
\item \code{file_type}: "itl" or "rsl"
\item \code{ambiguous_pct}: Percentage of f0-responses (1) in ambiguous items (rounded to 1 decimal)
\item \code{control_pct}: Percentage correct in control items (rounded to 1 decimal)
\item \code{n_ambivalent}: Count of ambivalent responses (code 2) - NA for .rsl files
\item \code{n_dont_know}: Count of "don't know" responses (code -1) - NA for .rsl files
\item \code{n_evaluable}: Number of evaluable trials (codes 0 or 1) - NA for .rsl files
\item \code{n_total}: Total number of trials - NA for .rsl files
\item \code{file}: Relative path to source CSV file
}
}
\description{
Recursively scans a directory for AAT files (filenames must contain "AAT").
Supports two file types:
\itemize{
\item .itl.csv files: Raw responses (Pitch Classification column)
\item .rsl.csv files: Computed results (already has ambiguous \%, control \%)
}
}
\details{
Extracts participant codes and dates from filenames, then calculates or reads AAT metrics:
\itemize{
\item Ambiguous (\%): Percentage of f0-responses (code 1) in ambiguous items
\item Control (\%): Percentage correct in control items
\item Quality metrics: counts of ambivalent (2) and "don't know" (-1) responses (for .itl only)
}

\strong{File format expected}:
\itemize{
\item CSV files with columns:
\itemize{
\item "Pitch Classification": 0 = spectral, 1 = f0, 2 = ambivalent, -1 = don't know
\item "Response": -1 = skip trial (excluded), 0/1/2 = participant response
\item "Nmin \link{-}": Identifies Control (same numbers, e.g. "3 3") vs Ambiguous (different, e.g. "5 2")
}
\item Filename format: \verb{AAT_response_<CODE>_<DATE>.itl.csv} or similar
}

\strong{Calculation logic (matching AAT manual and .rsl files)}:
\enumerate{
\item Filter out skip trials (Response == -1)
\item Aggregate by TONE PAIR (Reference F0, F0 Difference, Nmin, Phase)
\item Count F0 responses: Pitch Classification in c(1, 2) - BOTH codes count!
\item Formula: AAT Score \link{\%} = 100 * sum(# F0 per pair) / sum(# Items per pair)
\item Separate scores for Ambiguous (different Nmin) and Control (same Nmin)
}
}
\examples{
\dontrun{
# Scan all AAT files in folder
aat_data <- aat_scan("data/AAT")

# View results
View(aat_data)

# Filter for participants with high quality (few ambivalent responses)
aat_clean <- aat_data \%>\%
  filter(n_ambivalent < 5, n_dont_know < 3)
}
}
